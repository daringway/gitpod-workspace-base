#!/usr/bin/bash

ENV_NODE_VERSION=${1:-latest}

# Install nvm
# TODO not update .bashrc
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash

source ~/.nvm/nvm.sh

if [[ "${ENV_NODE_VERSION}" == "latest" ]]
then
    ENV_NODE_VERSION="--lts"
fi
nvm install ${ENV_NODE_VERSION}
nvm use ${ENV_NODE_VERSION}

# I think this is needed to get around the .bashrc only being used in execute mode
echo ". ~/.nvm/nvm-lazy.sh" >> ~/.bashrc.d/53-node